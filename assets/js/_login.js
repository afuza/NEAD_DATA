$(document).ready(function () { $("#login").submit(function (o) { o.preventDefault(), $("#login-btn").val("Loading..."), $("#login-btn").prop("disabled", !0); var r = $("#email").val(), o = $("#password").val(); $.ajax({ type: "POST", xhrFields: { withCredentials: !0, crossDomain: !0 }, url: api_uri + "/api/auth/login", contentType: "application/json", data: JSON.stringify({ username: r, password: o }), success: function (o, n, t) { 200 == t.status ? (token = o.accessToken, $.ajax({ url: api_uri + "/api/auth/flash", type: "POST", headers: { Authorization: "Bearer " + token, "Content-Type": "application/json" }, data: JSON.stringify({ username: r }), success: function (o, n, t) { o = o.refreshToken; 200 == t.status ? (Cookies.set("refreshToken", o, { expires: 7, path: "/" }), window.location.href = uriLocal + "/main/email.php?login=success") : (swal.fire({ icon: "error", title: "Oops...", text: "Something went wrong!", color: "#149414", confirmButtonColor: "#149414", cancelButtonColor: "transparent", confirmButtonText: "ok!", background: "black" }), $("#login-btn").val("Login"), $("#login-btn").prop("disabled", !1)) }, error: function (o, n, t) { swal.fire({ icon: "error", title: "Oops...", text: "Something went wrong!", iconColor: "#149414", color: "#149414", confirmButtonColor: "#149414", cancelButtonColor: "transparent", confirmButtonText: "ok!", background: "black" }) } })) : (swal.fire({ icon: "error", title: "Oops...", text: "Login Fail!", color: "#149414", confirmButtonColor: "#149414", cancelButtonColor: "transparent", confirmButtonText: "ok!", background: "black" }), $("#login-btn").val("Login"), $("#login-btn").prop("disabled", !1)) }, error: function (o, n, t) { return !1 } }) }) });