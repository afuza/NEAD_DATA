$(document).ready(function () { function a(a) { Swal.fire({ position: "top-end", icon: "error", title: a, showConfirmButton: !1, timer: 1500, iconColor: "#149414", confirmButtonColor: "#149414", background: "black" }), $("#loading").removeClass("disabled").attr("disabled", !1).val("Add Email") } function e(a, e) { Swal.fire({ iconColor: "#149414", confirmButtonColor: "#149414", background: "black", icon: "success", title: a, text: e, showCancelButton: !1 }).then(function (a) { a.isConfirmed && t() }) } function t() { $("#add-email")[0].reset(), $("#file-label").text("Choose file"), $("#image-preview").hide(), $("#loading").removeClass("disabled").attr("disabled", !1).val("Add Email") } TokenAcc().then(function (o) { var l = o.accessToken, i = $("#emaildata").DataTable({ ajax: { url: api_uri + "/api/v1/email/data", method: "GET", headers: { Authorization: "Bearer " + l }, dataType: "json", success: function (a) { var e, t; (e = $("#emaildata").DataTable()).clear(), t = 0, $.each(a, function (a, o) { var l = o.nohp.replace(/\D/g, ""), i = '<span style="color: ' + ("Active" === o.status ? "#149414" : "#e91b1b") + ';">' + ("Active" === o.status ? "On" : "Off") + "</span>", d = '<button class="link-ss" data-bs-toggle="modal" data-bs-target="#view_gambar" data-id="' + o._id + '">View</button>', n = '<button class="link-hapus" id="' + o._id + '">HAPUS</button>|<button class="edit bg-none-green"  data-bs-toggle="modal" data-bs-target="#editmodal" data-id="' + o._id + '">Edit</button>|<button type="button" class="note bg-note" data-bs-toggle="modal" data-bs-target="#dataModal" data-id="' + o._id + '">NOTE</button>', o = [++t, o.email, o.password, l, i, d, n]; e.row.add(o) }), e.draw() }, error: function (a, e, t) { alert("Error: " + t.message) } }, ordering: !0, paging: !0, searching: !0, lengthChange: !1, pageLength: 5, responsive: !0, pagingType: "simple", autoWidth: !0 }); $(".modal").on("shown.bs.modal", function (a) { var e = $(a.relatedTarget).data("id"), t = $(this).attr("id"); if ("inputdata" === t) return !1; $.ajax({ url: api_uri + "/api/v1/email/data/" + e, type: "GET", headers: { Authorization: "Bearer " + l }, success: function (a) { var o; "view_gambar" === t ? ($("#img_modal").html('<img class="hello_img" src="' + a.ss + '">'), $("#view_gambar").modal({ show: !0, backdrop: "static", keyboard: !1 })) : "editmodal" === t ? (o = a.nohp, $("#modal_email").val(a.email), $("#modal_password").val(a.password), $("#modal_nohp").val(o.replace(/\D/g, "")), $("#modal_note").val(a.note), $("#image-preview-3").attr("src", a.ss), $("#id-edit").val(e), $("#img-scr").val(a.ss), $('input[data-toggle="toggle"]').bootstrapToggle("Active" === a.status ? "on" : "off"), $("#editmodal").modal({ show: !0, backdrop: "static", keyboard: !1 })) : "dataModal" === t && (o = a.date || a.createdAt, o = new Date(o).toLocaleDateString("id-ID", { weekday: "long", year: "numeric", month: "long", day: "numeric", hour: "2-digit", minute: "2-digit", second: "2-digit" }), $("#your_modal_detail").html(a.note), $("#your_modal_date").html(o), $("#dataModal").modal({ show: !0, backdrop: "static", keyboard: !1 })) } }) }), $(document).on("click", ".link-hapus", function () { var a = $(this).attr("id"); Swal.fire({ title: "Are you sure?", text: "You won't be able to revert this!", icon: "warning", color: "#149414", iconColor: "#149414", background: "black", showCancelButton: !0, confirmButtonColor: "#149414", cancelButtonColor: "transparent", confirmButtonText: "Yes, delete it!" }).then(function (t) { t.isConfirmed && $.ajax({ url: api_uri + "/api/v1/email/data/" + a, type: "DELETE", headers: { Authorization: "Bearer " + l }, success: function () { e("Deleted!", "Your file has been deleted."), i.ajax.reload(null, !1) } }) }) }), $("#edit-email").submit(function (t) { t.preventDefault(), $("#loading-2").addClass("disabled").attr("disabled", !0).val("Please wait..."); var t = new FormData(this), o = $("#modal_email").val(), l = $("#modal_password").val(), d = $("#modal_nohp").val(); /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o) ? "" === o || "" === l || "" === d ? a("All fields are required!") : $.ajax({ url: "../core/nead_core.php", type: "POST", data: t, contentType: !1, processData: !1, success: function (a) { i.ajax.reload(null, !1), e("Success!", "Your file has been edited."), $("#editmodal").modal("hide"), $(".modal-backdrop.fade.show").removeClass("modal-backdrop").addClass("haibeb") }, error: function (a, e, t) { console.log(a.responseText) }, complete: function () { $("#loading-2").removeClass("disabled").attr("disabled", !1).val("Save changes") } }) : a("Email is not valid!") }), $("#add-email").submit(function (o) { o.preventDefault(), $("#loading").addClass("disabled").attr("disabled", !0).val("Please wait..."); var o = new FormData(this), l = $("#emailInput").val(), d = $("#passInput").val(), n = $("#nopeInput").val(), s = $("#file-input").val(); /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l) ? "" === l || "" === d || "" === n || "" === s ? a("All fields are required!") : $.ajax({ url: "../core/nead_core.php", type: "POST", data: o, contentType: !1, processData: !1, success: function (a) { i.ajax.reload(null, !1), e("Success!", "Your file has been added."), t() }, error: function (a, e, t) { console.log(a.responseText) }, complete: function () { $("#loading").removeClass("disabled").attr("disabled", !1).val("Add Email") } }) : a("Email is not valid!") }), setInterval(function () { i.ajax.reload(null, !1) }, 2e4) }).catch(function (a) { console.log(a) }) });